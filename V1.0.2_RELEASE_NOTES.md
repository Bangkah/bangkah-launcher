# Bangkah v1.0.2 Release Notes

**Release Date:** December 15, 2024

## üéØ Overview

Version 1.0.2 brings significant Docker improvements and critical bug fixes to ensure the generated Laravel starter kits work flawlessly out-of-the-box with modern PHP 8.4 and production-ready Nginx configurations.

## üöÄ What's New

### Docker Stack Modernization
- **PHP 8.4 Support**: Generated Dockerfiles now use `php:8.4-fpm` and `php:8.4-cli` base images
- **Nginx on Port 8080**: Default host port changed to 8080 to avoid conflicts and align with modern development practices
- **Smart Environment Bootstrapping**: Docker app service now automatically:
  - Copies `.env.example` to `.env` if missing
  - Generates `APP_KEY` via `php artisan key:generate`
  - Fixes storage and cache permissions with `chown www-data:www-data`
- **File-Based Sessions by Default**: Sets `SESSION_DRIVER=file` in generated Docker configs to eliminate database session table requirement for fresh installs
- **Vite Dev Server Optimization**: Node service configured to bind to `0.0.0.0:5173` with `strictPort: true` for reliable HMR

### Environment Configuration
Generated Docker Compose files now include comprehensive environment variables:
```yaml
environment:
  - APP_ENV=local
  - APP_DEBUG=true
  - APP_URL=http://localhost:8080
  - SESSION_DRIVER=file
  - DB_CONNECTION=mysql
  - DB_HOST=db
  - DB_PORT=3306
  - DB_DATABASE=laravel
  - DB_USERNAME=laravel
  - DB_PASSWORD=secret
```

### Networking Improvements
- **Internal-Only MySQL**: Removed external port mapping (3306) for MySQL service; database now accessible only within Docker network for improved security
- **Nginx Reverse Proxy**: Properly configured Nginx to proxy to `php-fpm` on internal port 9000

## üêõ Bug Fixes

### Critical: Vendor Directory Preservation
- **Fixed**: Scaffolding command was incorrectly deleting the `vendor/` directory after installation, causing "autoload.php not found" errors
- **Impact**: This was breaking `php artisan` commands immediately after scaffolding
- **Resolution**: Removed vendor deletion logic while keeping composer.lock cleanup

### Docker Startup Reliability
- **Fixed**: Containers were starting without proper environment setup, leading to "APP_KEY not set" and permissions errors
- **Solution**: Added startup command that bootstraps the application before php-fpm/artisan serve starts

## üìã Upgrading

### From v1.0.1
```bash
composer require bangkah/bangkah:^1.0
```

No breaking changes‚Äîexisting projects continue to work. New scaffolds will use the improved Docker stack automatically.

## ‚úÖ Verified Functionality

End-to-end testing confirms:
- ‚úÖ Fresh Laravel installation with `composer create-project laravel/laravel`
- ‚úÖ Package installation via `composer require bangkah/bangkah:^1.0`
- ‚úÖ Non-interactive scaffolding with `--yes --db=mysql --docker --nginx`
- ‚úÖ Docker stack builds and starts successfully
- ‚úÖ Health endpoint `/api/health` returns HTTP 200 with JSON
- ‚úÖ Root endpoint `/` returns HTTP 200 with proper session cookies
- ‚úÖ All services (PHP-FPM, Nginx, MySQL) communicate correctly

## üîó Links

- **GitHub Repository**: https://github.com/Bangkah/bangkah-launcher
- **Packagist**: https://packagist.org/packages/bangkah/bangkah
- **Documentation**: See [README.md](README.md)
- **Changelog**: [CHANGELOG.md](CHANGELOG.md)

## üëè Credits

Thanks to all contributors and testers who helped identify and resolve the vendor directory issue and Docker configuration challenges!

---

**Full Changelog**: https://github.com/Bangkah/bangkah-launcher/compare/v1.0.1...v1.0.2
